{
    "version": "0.1.0",
    "name": "limesurvey",
    "style": "php",
    "interactive": true,

    "publisher": {
        "maintainer": "Jonathan Cobb",
        "maintainer_email": "jonathan@cloudstead.io",
        "license": "http://manual.limesurvey.org/License",
        "code_copyright": "Copyright 2003-2015 LimeSurvey Project Team / Carsten Schmitz",
        "packaging_copyright": "Copyright 2014 Cloudstead, Inc."
    },

    "assets": { "taskbarIconAltText": "surveys" },

    "config": [ {
        "name": "init",
        "items": [ "admin.login", "admin.password", "admin.name", "admin.email", "admin.bounce",
                   "language", "title" ]
    } ],

    "tarball": {
        "url": "http://cloudstead.io/downloads/limesurvey-build150211.tar.gz",
        "shasum": "fee9fa2a5a3a2fa6b880e70c42bd50edbecb04b9e841aeb7fe17843282cc29d2"
    },

    "packages": [ "php5-gd", "php5-imap", "php5-ldap" ],

    "database": {
        "type": "mysql",
        "inserts": [
            { "sql": "INSERT INTO `lime_users` VALUES (1,'@config[init][admin][login]','@sha256(@config[init][admin][password])','@config[init][admin][name]',0,'@lang','@config[init][admin][email]','default','default','default',NULL,1,'@now(%Y-%m-%d %H:%M:%S)',NULL)",
              "unless": "SELECT COUNT(*) FROM lime_users WHERE users_name='@config[init][admin][login]'" },
            { "sql": "INSERT INTO lime_settings_global (stg_name, stg_value) VALUES ('SessionName', '@uniq[0]_@uniq[1]')",
              "unless": "SELECT COUNT(*) FROM lime_settings_global WHERE stg_name='SessionName'" },
            { "sql": "INSERT INTO lime_settings_global (stg_name, stg_value) VALUES ('sitename', '@config[init][title]')",
              "unless": "SELECT COUNT(*) FROM lime_settings_global WHERE stg_name='sitename'" },
            { "sql": "INSERT INTO lime_settings_global (stg_name, stg_value) VALUES ('siteadminname', '@config[init][admin][name]')",
              "unless": "SELECT COUNT(*) FROM lime_settings_global WHERE stg_name='siteadminname'" },
            { "sql": "INSERT INTO lime_settings_global (stg_name, stg_value) VALUES ('siteadminemail', '@config[init][admin][email]')",
              "unless": "SELECT COUNT(*) FROM lime_settings_global WHERE stg_name='siteadminemail'" },
            { "sql": "INSERT INTO lime_settings_global (stg_name, stg_value) VALUES ('siteadminbounce', '@config[init][admin][bounce]')",
              "unless": "SELECT COUNT(*) FROM lime_settings_global WHERE stg_name='siteadminbounce'" },
            { "sql": "INSERT INTO lime_settings_global (stg_name, stg_value) VALUES ('defaultlang', '@lang')",
              "unless": "SELECT COUNT(*) FROM lime_settings_global WHERE stg_name='defaultlang'" }
        ]
    },

    "web": {
        "type": "apache",
        "mode": "service",
        "apache": {
            "php_set": [
                { "name": "extension", "value": "pdo_pgsql.so" },
                { "name": "extension", "value": "imap.so" }
            ]
        }
    },

    "templates": {
        "@doc_root/application/config/config.php": "_"
    },

    "perms": {
         "@doc_root/tmp": { "perms": "770", "recursive": true },
         "@doc_root/upload": { "perms": "770", "recursive": true },
         "@doc_root/application/config": { "perms": "770", "recursive": true }
    },

    "mailboxes": [ { "address": "surveys", "alias_for": "postmaster" } ],

    "auth": {
        "home_path": "/limesurvey/admin",
        "login_path": "/limesurvey/index.php/admin/authentication/sa/login",
        "login_fields": {
            "authMethod": "AuthLDAP",
            "user": "{{account.name}}",
            "password": "{{account.password}}",
            "loginlang": "default",
            "action": "login",
            "login_submit": "Login"
        }
    }
}
