<% ldap=@app[:auth][:ldap] %>

[libdefaults]
        default_realm = <%=ldap.realm%>
        dns_lookup_kdc = false

[realms]
        <%=ldap.realm%> = {
                kdc = <%=@app[:hostname]%>
                admin_server = <%=@app[:hostname]%>
                default_domain = <%=@app[:domain]%>
                database_module = openldap_ldapconf
        }

[domain_realm]
        <%=@app[:domain]%> = <%=ldap.realm%>
        .<%=@app[:domain]%> = <%=ldap.realm%>

[login]
        krb4_convert = false
        krb4_get_tickets = false

[logging]
        kdc = FILE:/var/log/kerberos/krb5kdc.log
        admin_server = FILE:/var/log/kerberos/kadmin.log
        default = FILE:/var/log/kerberos/krb5lib.log

[dbdefaults]
    ldap_kerberos_container_dn = <%=ldap.base_dn%>

[dbmodules]
    openldap_ldapconf = {
        db_library = kldap
        ldap_kdc_dn = "<%=ldap.admin_dn%>"

        # this object needs to have read rights on
        # the realm container, principal container and realm sub-trees
        ldap_kadmind_dn = "<%=ldap.admin_dn%>"

        # this object needs to have read and write rights on
        # the realm container, principal container and realm sub-trees
        ldap_service_password_file = /etc/krb5kdc/service.keyfile
        ldap_servers = ldapi:///
        ldap_conns_per_server = 5
    }